#include <iostream>
#include <math.h>
using namespace std;
#define PI 3.14159265359
int main()
{
while(1){
float u = 0; // wanted angle
cout << "Enter an angle (in deg) : ";
cin >> u;
float s = 1;
float t = -1.5;
float c = 1; // servo arm length
float b = s; // connector arm length
float a = -t + c; // TVC mount "arm" length
// coordinates at the end of the TVC gimbal arm
float m = s - a * sinf(u * PI / 180);
float n = t + a * cosf(u * PI / 180);
// quick commonly used vars
float m2 = m*m;
float n2 = n*n;
float b2 = b*b;
float c2 = c*c;
float m4 = m2*m2;
float n4 = n2*n2;
float b4 = b2*b2;
float c4 = c2*c2;
float p = (-b2*m-sqrt(-
b4*n2 + 2*b2*c2*n2 + 2*b2*m2*n2 + 2*b2*n4 - c4*n2 + 2*c2*m2*n2 + 2*c2*n4 - m4*n2 - 2*m2*n4 - n
2*n4) + c2*m + m*m2 + m*n2)/(2*(m2+n2));
float q = sqrt(c2-p*p);
float v = -atan2(p,q)*180/PI; // angle that servo needs to rotate to
float w = u * a / c; // estimate using the ratio of the lengths of the TVC arm and the
servo arm
cout << "Real servo angle : " << v << " deg" << endl;
cout << "Estimation : " << w << " deg" << endl << endl;
}
}